<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syntax Highlighting Demo - aiNote</title>
    <link rel="stylesheet" href="src/js/components/markdown-editor.css">
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8fafc;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        .editor-container {
            height: 600px;
            margin: 20px 0;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
        }
        .controls {
            margin: 20px 0;
        }
        .controls button {
            margin: 5px;
            padding: 8px 16px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .controls button:hover {
            background: #2563eb;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
        .stat {
            padding: 10px;
            background: #f3f4f6;
            border-radius: 4px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé® Syntax Highlighting Demo</h1>
        <p>This demonstrates the custom markdown syntax highlighting engine for aiNote.</p>
        
        <div class="controls">
            <button onclick="toggleHighlighting()">Toggle Highlighting</button>
            <button onclick="loadDemoContent()">Load Demo Content</button>
            <button onclick="clearContent()">Clear Content</button>
            <button onclick="showPerformanceStats()">Show Stats</button>
        </div>
        
        <div class="editor-container" id="editor-container"></div>
        
        <div id="stats" class="stats"></div>
        
        <div id="status" style="margin-top: 10px; padding: 10px; background: #e5e7eb; border-radius: 4px;"></div>
    </div>

    <script type="module">
        import MarkdownEditor from './src/js/components/markdown-editor.js';

        // Mock AppState for testing
        class MockAppState {
            constructor() {
                this.data = {};
            }
            
            get(key) { return this.data[key]; }
            set(key, value) { this.data[key] = value; }
            save() { return Promise.resolve(); }
        }

        const demoMarkdown = `# üöÄ Complete Markdown Syntax Demo

## Headings
# Heading 1
## Heading 2
### Heading 3
#### Heading 4
##### Heading 5
###### Heading 6

## Text Formatting
This paragraph has **bold text**, *italic text*, ***bold and italic***, and ~~strikethrough~~.

You can also use __double underscore bold__ and _single underscore italic_.

## Code Examples
Here's some \`inline code\` in a sentence.

\`\`\`javascript
// Code block with syntax highlighting
function greetUser(name) {
    const message = \`Hello, \${name}!\`;
    console.log(message);
    return message;
}

greetUser('World');
\`\`\`

\`\`\`python
def fibonacci(n):
    if n <= 1:
        return n
    return fibonacci(n-1) + fibonacci(n-2)

print([fibonacci(i) for i in range(10)])
\`\`\`

## Links and References
Visit [Google](https://google.com) or check out [GitHub](https://github.com).

You can also use reference-style links like [this one][1].

[1]: https://example.com

## Lists
### Unordered Lists
- First item
- Second item
  - Nested item
  - Another nested item
    - Deep nesting
- Third item

### Ordered Lists
1. First ordered item
2. Second ordered item
   1. Nested ordered item
   2. Another nested ordered item
3. Third ordered item

## Blockquotes
> This is a simple blockquote.
> It can span multiple lines.

> > This is a nested blockquote.
> > It shows multiple levels of quoting.

> ### Blockquotes can contain other elements
> 
> Including **formatted text** and \`code\`.

## Tables
| Column 1 | Column 2 | Column 3 |
|----------|----------|----------|
| Cell 1   | Cell 2   | Cell 3   |
| **Bold** | *Italic* | \`Code\`   |
| Data A   | Data B   | Data C   |

## Mixed Content
This paragraph demonstrates **bold _italic_** nesting, along with \`inline code\` and [links](https://example.com).

> **Quote with formatting**: This shows how _various_ **elements** can be \`combined\` in a [blockquote](https://example.com).

## Performance Test
${'This is a longer paragraph that tests the performance of the syntax highlighter with more content. '.repeat(10)}

**Bold text performance test**: ${'Bold content repeated multiple times. '.repeat(5)}

*Italic text performance test*: ${'Italic content repeated multiple times. '.repeat(5)}

\`\`\`
Code block performance test:
${'Line of code that is repeated to test performance.\n'.repeat(20)}
\`\`\`

That's a comprehensive demonstration of all supported markdown syntax elements! üéâ`;

        // Initialize editor
        let editor;
        let appState;

        function initializeEditor() {
            try {
                const container = document.getElementById('editor-container');
                appState = new MockAppState();
                editor = new MarkdownEditor(container, appState);
                
                updateStatus('‚úÖ Editor initialized successfully');
                
                // Set initial demo content
                setTimeout(() => {
                    editor.setValue(demoMarkdown);
                    updateStatus('üìù Demo content loaded');
                }, 200);
                
            } catch (error) {
                console.error('Failed to initialize editor:', error);
                updateStatus('‚ùå Failed to initialize editor: ' + error.message);
            }
        }

        function toggleHighlighting() {
            if (editor) {
                const currentState = editor.highlightingEnabled;
                editor.toggleSyntaxHighlighting(!currentState);
                updateStatus(\`‚ú® Highlighting \${!currentState ? 'enabled' : 'disabled'}\`);
            }
        }

        function loadDemoContent() {
            if (editor) {
                editor.setValue(demoMarkdown);
                updateStatus('üìù Demo content reloaded');
            }
        }

        function clearContent() {
            if (editor) {
                editor.setValue('');
                updateStatus('üßπ Content cleared');
            }
        }

        function showPerformanceStats() {
            if (editor) {
                const stats = editor.getStats();
                const syntaxStats = editor.getSyntaxHighlightingStats();
                
                const statsContainer = document.getElementById('stats');
                statsContainer.innerHTML = \`
                    <div class="stat"><strong>Content:</strong> \${stats.contentLength} chars</div>
                    <div class="stat"><strong>Words:</strong> \${stats.wordCount} words</div>
                    <div class="stat"><strong>Lines:</strong> \${(editor.getValue().match(/\n/g) || []).length + 1}</div>
                    <div class="stat"><strong>Highlighting:</strong> \${syntaxStats.enabled ? '‚úÖ Enabled' : '‚ùå Disabled'}</div>
                    <div class="stat"><strong>Last Highlight:</strong> \${syntaxStats.lastHighlightTime?.toFixed(2) || 'N/A'}ms</div>
                    <div class="stat"><strong>Total Highlights:</strong> \${syntaxStats.totalHighlights || 0}</div>
                    <div class="stat"><strong>Cache Size:</strong> \${syntaxStats.cacheSize || 0}</div>
                    <div class="stat"><strong>Average Time:</strong> \${syntaxStats.averageTime?.toFixed(2) || 'N/A'}ms</div>
                \`;
                
                updateStatus('üìä Performance statistics updated');
                
                console.log('üìä Performance Stats:', stats);
                console.log('‚ú® Syntax Highlighting Stats:', syntaxStats);
            }
        }

        function updateStatus(message) {
            const statusElement = document.getElementById('status');
            statusElement.textContent = new Date().toLocaleTimeString() + ': ' + message;
            console.log(message);
        }

        // Make functions global for buttons
        window.toggleHighlighting = toggleHighlighting;
        window.loadDemoContent = loadDemoContent;
        window.clearContent = clearContent;
        window.showPerformanceStats = showPerformanceStats;

        // Initialize when DOM loads
        document.addEventListener('DOMContentLoaded', () => {
            updateStatus('üîÑ Initializing editor...');
            initializeEditor();
        });

        // Auto-refresh stats every 3 seconds
        setInterval(() => {
            if (editor && editor.highlightingEnabled) {
                showPerformanceStats();
            }
        }, 3000);

        // Monitor for errors
        window.addEventListener('error', (event) => {
            updateStatus('‚ùå Error: ' + event.message);
            console.error('Global error:', event);
        });
    </script>
</body>
</html>