<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="js/components/file-tree.css" />
    <link rel="stylesheet" href="js/components/context-menu.css" />
    <link rel="stylesheet" href="js/components/markdown-editor.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>aiNote</title>
    <script type="module" src="/main.js" defer></script>
  </head>

  <body>
    <!-- Three-column layout system -->
    <div class="app-container">
      <!-- File Tree Panel -->
      <aside class="file-tree-panel" id="fileTreePanel">
        <header class="panel-header">
          <h2>File Tree</h2>
          <div class="panel-controls">
            <button id="searchBtn" class="control-btn" onclick="activateFileTreeSearch()" aria-label="Search files (Ctrl+F)" title="Search files (Ctrl+F)">
              🔍
            </button>
            <button id="selectVaultBtn" class="control-btn" onclick="selectVault()" aria-label="Select vault folder">
              📁
            </button>
            <button id="refreshBtn" class="control-btn" onclick="refreshVault()" aria-label="Refresh vault">
              🔄
            </button>
          </div>
        </header>
        <div class="vault-info" id="vaultInfo">
          <span class="vault-path">No vault selected</span>
        </div>
        <div class="file-tree-content" id="fileTreeContent">
          <div class="empty-state">
            <p>Select a vault folder to browse files</p>
            <button onclick="selectVault()" class="btn-primary">Select Vault</button>
          </div>
        </div>
        <!-- Resize handle -->
        <div class="resize-handle resize-handle-right" data-direction="horizontal" data-panel="file-tree"></div>
      </aside>

      <!-- Editor/Preview Panel -->
      <main class="editor-panel" id="editorPanel">
        <header class="panel-header">
          <div class="editor-title">
            <button class="file-tree-expand-btn" id="fileTreeExpandBtn" onclick="toggleFileTree()" aria-label="Toggle file tree">
              ⬅️
            </button>
            <h2 id="currentFileName">Welcome to aiNote</h2>
            <span class="file-status" id="fileStatus"></span>
          </div>
          <div class="panel-controls">
            <button id="newFileBtn" class="control-btn" onclick="createNewFile()" aria-label="New file">
              📄
            </button>
            <button id="saveFileBtn" class="control-btn" onclick="saveFile()" aria-label="Save file" disabled>
              💾
            </button>
            <button id="toggleModeBtn" class="control-btn" onclick="toggleViewMode()" aria-label="Toggle editor/preview">
              👁
            </button>
            <button id="toggleAiBtn" class="control-btn" onclick="toggleAiPanel()" aria-label="Toggle AI panel (Cmd+2)" title="Toggle AI Panel (Cmd+2)">
              🤖
            </button>
          </div>
        </header>
        <div class="editor-content" id="editorContent">
          <div class="welcome-content">
            <h1>Welcome to aiNote</h1>
            <p>A local-first, AI-powered markdown note-taking application.</p>
            <div class="quick-actions">
              <button onclick="selectVault()" class="btn-primary">Get Started - Select Vault</button>
            </div>
          </div>
        </div>
        <!-- Resize handle -->
        <div class="resize-handle resize-handle-right" data-direction="horizontal" data-panel="editor"></div>
      </main>

      <!-- AI Panel (Hidden in Phase 1) -->
      <aside class="ai-panel" id="aiPanel" style="display: none;">
        <header class="panel-header">
          <h2>AI Assistant</h2>
          <div class="panel-controls">
            <button id="closeAiBtn" class="control-btn" onclick="toggleAiPanel()" aria-label="Close AI panel">
              ✕
            </button>
          </div>
        </header>
        <div class="ai-content" id="aiContent">
          <div class="ai-placeholder">
            <p>AI features coming in Phase 2</p>
          </div>
        </div>
      </aside>
    </div>

    <!-- Mobile Navigation Overlay -->
    <div class="mobile-nav-overlay" id="mobileNavOverlay" style="display: none;">
      <div class="mobile-nav-header">
        <h3>Navigation</h3>
        <button class="close-nav" onclick="closeMobileNav()" aria-label="Close navigation">✕</button>
      </div>
      <div class="mobile-nav-content" id="mobileNavContent">
        <!-- File tree content will be cloned here on mobile -->
      </div>
    </div>

    <!-- Mobile Navigation Toggle -->
    <button class="mobile-nav-toggle" id="mobileNavToggle" onclick="openMobileNav()" aria-label="Open navigation" style="display: none;">
      ☰
    </button>

    <!-- Keyboard Shortcuts Help (Hidden by default) -->
    <div class="shortcuts-help" id="shortcutsHelp" style="display: none;">
      <div class="shortcuts-content">
        <h3>Keyboard Shortcuts</h3>
        <div class="shortcuts-list">
          <div class="shortcut"><kbd>Ctrl/Cmd</kbd> + <kbd>N</kbd> - New file</div>
          <div class="shortcut"><kbd>Ctrl/Cmd</kbd> + <kbd>S</kbd> - Save file</div>
          <div class="shortcut"><kbd>Ctrl/Cmd</kbd> + <kbd>O</kbd> - Open vault</div>
          <div class="shortcut"><kbd>Ctrl/Cmd</kbd> + <kbd>E</kbd> - Toggle editor/preview</div>
          <div class="shortcut"><kbd>Ctrl/Cmd</kbd> + <kbd>1</kbd> - Toggle file tree</div>
          <div class="shortcut"><kbd>Ctrl/Cmd</kbd> + <kbd>2</kbd> - Toggle AI panel</div>
          <div class="shortcut"><kbd>Ctrl/Cmd</kbd> + <kbd>F</kbd> - Search files (in file tree)</div>
          <div class="shortcut"><kbd>↑↓←→</kbd> - Navigate file tree</div>
          <div class="shortcut"><kbd>Enter</kbd> - Open file / Toggle folder</div>
          <div class="shortcut"><kbd>Home/End</kbd> - Go to first/last item</div>
          <div class="shortcut"><kbd>Ctrl/Cmd</kbd> + <kbd>/</kbd> - Show/hide shortcuts</div>
          <div class="shortcut"><kbd>Esc</kbd> - Close dialogs / Exit search</div>
        </div>
        <button onclick="toggleShortcutsHelp()" class="btn-primary">Close</button>
      </div>
    </div>

    <!-- Accessibility helper for external links -->
    <div id="external-link-description" style="position: absolute; left: -10000px; width: 1px; height: 1px; overflow: hidden;">
      Opens in a new tab
    </div>
  </body>
</html>
